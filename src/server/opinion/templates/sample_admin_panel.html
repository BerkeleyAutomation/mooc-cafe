<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Opinion Space 2.1 Admin Panel</title>
</head>

<script type="text/javascript" src="http://hkn.eecs.berkeley.edu/~dwong/research/dojo.js"></script>
<body style="background-color: #001f37; color:#FFFFFF; font-family: sans-serif;" link="#fedd6c" alink="#fedd6c" vlink="#fedd6c">
	<div id="main" style="margin: 20px;">
		<h2>Statistics</h2>
		<div>
			<span>Total number of users in the space: </span>
			<div id="userCount">0</div>
		</div>
		
		<h2>Manage Top Comments</h2>
		<table id="commentsTable"></table>
	</div>
</body>

<script type="text/javascript">

	// Get statistics and top rated comments
	dojo.xhrGet({
			url: "/admincontent/1/",
			handleAs: "json",
			load:function(response, ioArgs){
				if (response.success){
					populateDashboard(response.data);
				}	
			},
			error:function(data){ // This happens on a 500 error or alikes.
				alert('Error: failed sending data');
			}
		});
	
	function populateDashboard(arr) {
		var topComments = arr[0];
		var numUsers = arr[1];
		
		// set the total number of users
		dojo.byId('userCount').innerHTML = numUsers;
		
		// display the comments
		for (var i=0; i<topComments.length; i++) {
			var row = document.createElement('tr');
			
			var button = document.createElement('input');
			button.setAttribute("type", "button");
			button.setAttribute("value", "Remove");
			button.setAttribute("style", "margin-right: 10px;");
			
			var user = document.createElement('td');
			user.innerHTML = 'user ' + topComments[i][0];
			user.setAttribute("style", "padding-right: 10px;");
			
			var comment = document.createElement('td');
			comment.innerHTML = topComments[i][1];
			
			row.appendChild(button);
			row.appendChild(user);
			row.appendChild(comment);
			dojo.byId('commentsTable').appendChild(row);
		}	
	}
	
</script>
</html>